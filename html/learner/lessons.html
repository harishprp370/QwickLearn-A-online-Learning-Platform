<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qwick Learn - Student lessons</title>
    <link rel="stylesheet" href="../../css/learner/lessons.css">
</head>
<body>
         
<!-- Header -->
<header class="mheader">
    <nav class="navi">
      <div class="logo"> 
        <img src="../../assets/img/logo.png" alt="Logo">
      </div>
      <div class="search-bar">
        <input type="text" placeholder="Want to learn?">
        <div class="dropdown">
          <button class="dropbtn">Explore &#9662;</button>
          <div class="dropdown-content">
              <a href="#">Cyber Security</a>
              <a href="#">Web Development</a>
              <a href="#">Data Science</a>
          </div>
     </div> 
      </div>
      <ul class="nav-menus">
        <li><a href="../home.html">Home</a></li>
        <li><a href="../about.html">About us</a></li>
        <li><a href="../contactus.html">Contact us</a></li>
        <li><a href="../faq.html">FAQ's</a></li>
        <li><a href="../courses.html">Courses</a></li>
      </ul>

    </nav>
  </header>

  <!--Main Content-->
    <div class="container">
        <nav class="breadcrumb">
            <a href="mylearning.html">Home</a> >
            <span id="course-name">Course Name</span>
        </nav>
        <div class="content">
            <div class="main-content">
                <div class="video-section">
                    <iframe id="video-frame" class="video-placeholder" frameborder="0"></iframe>
                </div>
                <div class="tabs">
                    <button class="tablink" onclick="openTab(event, 'Overview')">Overview</button>
                    <button class="tablink" onclick="openTab(event, 'Notes')">Notes</button>
                    <button class="tablink" onclick="openTab(event, 'Resources')">Resources</button>
                    <button class="tablink" onclick="openTab(event, 'Quiz')">Quiz</button>
                </div>
                <div class="tabcontent" id="Overview">
                    <p id="overview-content">Overview content goes here.</p>
                </div>
                <div class="tabcontent" id="Notes">
                    <textarea id="notes-text" rows="10" cols="100" placeholder="Write your notes here..."></textarea><br>
                    <button onclick="downloadNotes()">Download Notes</button>
                </div>
                <div class="tabcontent" id="Resources">
                    <ul id="resources-list"></ul>
                </div>
                <div class="tabcontent" id="Quiz">
                    <p>Quiz content goes here.</p>
                </div>
                <button id="certificate-button" style="display: none;">Get Certificate</button>
            </div>
            <div class="sidebar">
                <div class="topic-list">
                    <p>LIST OF TOPICS</p>
                    <ul id="topic-list">
                        <!-- Topics will be loaded here dynamically -->
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const urlParams = new URLSearchParams(window.location.search);
            const courseId = urlParams.get('course');

            fetch('../../jsonfles/courseSrc.json')
                .then(response => response.json())
                .then(data => {
                    const course = data.courses[courseId];
                    if (course) {
                        document.getElementById("course-name").textContent = course.name;

                        // Load Overview
                        document.getElementById("overview-content").textContent = course.overview;

                        // Load Topics
                        const topicList = document.getElementById("topic-list");
                        course.topics.forEach(topic => {
                            const li = document.createElement("li");
                            const a = document.createElement("a");
                            a.href = "#";
                            a.textContent = topic.title;
                            a.onclick = function() {
                                loadVideo(topic.video);
                            };
                            li.appendChild(a);
                            topicList.appendChild(li);
                            
                        });

                        // Load Resources
                        const resourcesList = document.getElementById("resources-list");
                        course.resources.forEach(resource => {
                            const li = document.createElement("li");
                            const a = document.createElement("a");
                            a.href = resource.url;
                            a.textContent = resource.name;
                            a.setAttribute('download', '');
                            li.appendChild(a);
                            resourcesList.appendChild(li);
                        });
                        if (course.topics.every(topic => topic.completed)) {
                            document.getElementById("certificate-button").style.display = 'block';
                        }
                    }
                })

                .catch(error => console.error('Error loading video data:', error));

            function loadVideo(videoUrl) {
                const videoFrame = document.getElementById('video-frame');
                videoFrame.src = videoUrl;
            }

            window.openTab = function(evt, tabName) {
                var i, tabcontent, tablinks;
            
                // Get all elements with class="tabcontent" and hide them
                tabcontent = document.getElementsByClassName("tabcontent");
                for (i = 0; i < tabcontent.length; i++) {
                    tabcontent[i].style.display = "none";
                }
            
                // Get all elements with class="tablink" and remove the class "active"
                tablinks = document.getElementsByClassName("tablink");
                for (i = 0; i < tablinks.length; i++) {
                    tablinks[i].classList.remove("active");
                }
            
                // Show the current tab, and add an "active" class to the button that opened the tab
                document.getElementById(tabName).style.display = "block";
                evt.currentTarget.classList.add("active");
            }
            
            window.downloadNotes = function() {
                const notes = document.getElementById('notes-text').value;
                const blob = new Blob([notes], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'notes.txt';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            };
        });
    </script>
</body>
</html>
